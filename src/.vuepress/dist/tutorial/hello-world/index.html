<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hello, world! | Huff Language</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Documentation for the Huff Language">
    <meta name="theme-color" content="#c70202">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.b0a66cc0.css" as="style"><link rel="preload" href="/assets/js/app.57115abc.js" as="script"><link rel="preload" href="/assets/js/2.cac86936.js" as="script"><link rel="preload" href="/assets/js/20.b6486faf.js" as="script"><link rel="prefetch" href="/assets/js/10.1a30c261.js"><link rel="prefetch" href="/assets/js/11.ebabbb0d.js"><link rel="prefetch" href="/assets/js/12.4eaa7a76.js"><link rel="prefetch" href="/assets/js/13.e18132a6.js"><link rel="prefetch" href="/assets/js/14.3dd2f170.js"><link rel="prefetch" href="/assets/js/15.7da684d7.js"><link rel="prefetch" href="/assets/js/16.95943230.js"><link rel="prefetch" href="/assets/js/17.a939c1db.js"><link rel="prefetch" href="/assets/js/18.d1f37e1c.js"><link rel="prefetch" href="/assets/js/19.0ce23908.js"><link rel="prefetch" href="/assets/js/21.4f63ea33.js"><link rel="prefetch" href="/assets/js/22.1d7ebcba.js"><link rel="prefetch" href="/assets/js/23.5a61b8fb.js"><link rel="prefetch" href="/assets/js/24.98a962d6.js"><link rel="prefetch" href="/assets/js/3.b85b684d.js"><link rel="prefetch" href="/assets/js/4.25622e79.js"><link rel="prefetch" href="/assets/js/5.77aa7fd5.js"><link rel="prefetch" href="/assets/js/6.1831b8d9.js"><link rel="prefetch" href="/assets/js/7.93f46b2e.js"><link rel="prefetch" href="/assets/js/8.8354b5da.js"><link rel="prefetch" href="/assets/js/9.4afd65b3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b0a66cc0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Huff Language</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/get-started/overview/" class="nav-link">
  Get Started
</a></div><div class="nav-item"><a href="/tutorial/overview/" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><a href="/style-guide/overview/" class="nav-link">
  Style Guide
</a></div><div class="nav-item"><a href="/resources/overview/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/contribute/overview/" class="nav-link">
  Contribute
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/get-started/overview/" class="nav-link">
  Get Started
</a></div><div class="nav-item"><a href="/tutorial/overview/" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><a href="/style-guide/overview/" class="nav-link">
  Style Guide
</a></div><div class="nav-item"><a href="/resources/overview/" class="nav-link">
  Resources
</a></div><div class="nav-item"><a href="/contribute/overview/" class="nav-link">
  Contribute
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tutorial/overview/" class="sidebar-link">Overview</a></li><li><a href="/tutorial/evm-basics/" class="sidebar-link">Understanding the EVM</a></li><li><a href="/tutorial/the-basics/" class="sidebar-link">The Basics</a></li><li><a href="/tutorial/hello-world/" aria-current="page" class="active sidebar-link">Hello, world!</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorial/hello-world/#primer-abi-encoding" class="sidebar-link">Primer: ABI Encoding</a></li><li class="sidebar-sub-header"><a href="/tutorial/hello-world/#implementation" class="sidebar-link">Implementation</a></li></ul></li><li><a href="/tutorial/simple-storage/" class="sidebar-link">Simple Storage</a></li><li><a href="/tutorial/huff-testing/" class="sidebar-link">Testing Huff with Foundry</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hello-world"><a href="#hello-world" class="header-anchor">#</a> Hello, world!</h1> <p>Note: This section is a continuation of <a href="/tutorial/the-basics/">'The Basics'</a>. If you have not read it yet we recommend you take a look at it before continuing!</p> <hr> <p>Within <a href="/tutorial/the-basics/">'The Basics'</a> we mentioned how <code>&quot;Hello, world!&quot;</code> is quite an advanced concept for Huff. The reason being that we have to an understanding of how string's are encoded in the EVM.</p> <h2 id="primer-abi-encoding"><a href="#primer-abi-encoding" class="header-anchor">#</a> Primer: ABI Encoding</h2> <p>As strings are dynamic types it is not as simple as returning the UTF-8 values for <code>&quot;Hello, world!&quot;</code> (<code>0x48656c6c6f2c20776f726c6421</code>). In the ABI standard, dynamic types are encoded in 3 parts.</p> <ol><li>The offset of the dynamic data. (A pointer to the start of the dynamic data (uint256))</li> <li>The length of the dynamic data. (uint256)</li> <li>The values of the dynamic data. (dynamic length)</li></ol> <p>Each part will look as follows for the string <code>&quot;Hello, world!&quot;</code>:</p> <div class="language- extra-class"><pre class="language-text"><code>[Byte number]   [DATA]    
0x00            0000000000000000000000000000000000000000000000000000000000000020 // The location of the &quot;Hello, world!&quot; data (dynamic type).
0x20            000000000000000000000000000000000000000000000000000000000000000d // The length of &quot;Hello, world!&quot; in bytes
0x40            48656c6c6f2c20776f726c642100000000000000000000000000000000000000 // Value &quot;Hello, world!&quot;
</code></pre></div><p>Encoding dynamic values takes alot of work!! In order to return <code>&quot;Hello, world!&quot;</code> we must return 96 bytes!</p> <p>You might think that we can populate the memory in sequential order starting with the location (0x00), then length (0x20), and then the value (0x40). However, this would result in the value &quot;Hello, world!&quot; being left padded. We would get:</p> <div class="language- extra-class"><pre class="language-text"><code>[Byte number]   [DATA]    
0x00            0000000000000000000000000000000000000000000000000000000000000020 // The location of the &quot;Hello, world!&quot; data (dynamic type).
0x20            000000000000000000000000000000000000000000000000000000000000000d // The length of &quot;Hello, world!&quot; in bytes
0x40            0000000000000000000000000000000000000048656c6c6f2c20776f726c6421 // Wrong encoding!
</code></pre></div><p>This is not what we need. Instead, we're going to leverage what we know about memory to produce the right result:</p> <ul><li>Memory is always expanded in 32 byte increments</li> <li>We can store a value starting from any index</li> <li>Values are left padded</li></ul> <p>Additionaly, in this example, we know that we want to store the location starting at 0x00 and the length starting at 0x20.</p> <p>Armed with this knowledge, we can store the value &quot;Hello, world!&quot; at 0x2d (starting index of length 0x20 + the length of the data in bytes 0x0d). The first 0x2d (decimal 45) bytes are set to zero as a result of memory expansion. The left padding of &quot;Hello, world!&quot; is stored from bytes 0x2d (decimal 45)-&gt; 0x3f (decimal 63).</p> <p>This means our important bytes (<code>48656c6c6f2c20776f726c6421</code>) start at 0x40. However, since memory is expanded in 32 byte increments empty memory will be expanded with zeros to byte 0x60 (decimal 96), exactly what we need!</p> <div class="language- extra-class"><pre class="language-text"><code>[Byte number]   [DATA]    
0x00            0000000000000000000000000000000000000000000000000000000000000000 // Empty
0x20            0000000000000000000000000000000000000000000000000000000000000000 // Empty
0x40            48656c6c6f2c20776f726c642100000000000000000000000000000000000000 // Correct encoding 
</code></pre></div><p>Now we have &quot;Hello, world!&quot; stored, we have two things left to do. Store the length of the string in 0x20, and a pointer to the start of our dynamic data 0x00! Now let's see what that looks like in code.</p> <h2 id="implementation"><a href="#implementation" class="header-anchor">#</a> Implementation</h2> <p>The following <code>MAIN</code> macro steps through this encoding in a clear way (gas optimization will be left as an exercise to the reader!)</p> <div class="language- extra-class"><pre class="language-text"><code>#define macro MAIN() = takes(0) returns(0) {
    // Store string &quot;Hello, world1&quot; in memory at 0x40
    // 0x2d is listed as mstore pads the value
    0x48656c6c6f2c20776f726c6421        // [&quot;Hello, world!&quot;]
    0x2d                                // [0x2d, &quot;Hello, world!&quot;]
    mstore                              // []

    // store length of string at 0x20
    0x0d                                // [0x0d]
    0x20                                // [0x20, 0x0d]
    mstore                              // []
    
    // store dynamic offset at 0x00 (string encoding starts at 0x20)
    0x20                                // [0x20]
    0x00                                // [0x00, 0x20]
    mstore                              // []

    // return full 96 byte value
    0x60                                // [0x60]
    0x00                                // [0x00, 0x60]
    return                              // []
}
</code></pre></div><p>Have a look how memory is set and what is returned interactively within the <a href="https://www.evm.codes/playground?unit=Wei&amp;codeType=Bytecode&amp;code='6c48656c6c6f2c20776f726c6421~2dz0d~20z20~00z~~00f3'~60z52~%01z~_" target="_blank" rel="noopener noreferrer">evm.codes playground<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for this example.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tutorial/the-basics/" class="prev">
        The Basics
      </a></span> <span class="next"><a href="/tutorial/simple-storage/">
        Simple Storage
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.57115abc.js" defer></script><script src="/assets/js/2.cac86936.js" defer></script><script src="/assets/js/20.b6486faf.js" defer></script>
  </body>
</html>
