(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{447:function(t,e,a){"use strict";a.r(e);var o=a(66),r=Object(o.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"understanding-the-evm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#understanding-the-evm"}},[t._v("#")]),t._v(" Understanding the EVM")]),t._v(" "),a("p",[t._v("The Ethereum Virtual Machine, or EVM for short, is the brains behind Ethereum. It's a computation engine, as the name suggests, similar to the virtual machines in Microsoft's.NET Framework or interpreters for other bytecode-compiled programming languages like Java.")]),t._v(" "),a("p",[t._v("The EVM is the part of the Ethereum protocol that controls the deployment and execution of smart contracts. It can be compared to a global decentralized computer with millions of executable things (contracts), each with its own permanent data store.")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"/evm.png",width:"640px"}})]),t._v(" "),a("figcaption",{attrs:{align:"center"}},[a("b",[t._v("Fig.1 - EVM from "),a("i",[t._v("Ethereum EVM Illustrated")]),t._v(" by Takenobu T.")])]),t._v(" "),a("h2",{attrs:{id:"technical"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#technical"}},[t._v("#")]),t._v(" Technical")]),t._v(" "),a("blockquote",[a("p",[a("strong",[a("em",[t._v("NOTE:")])]),t._v(" This tutorial assumes that you are somewhat familiar with Solidity and therefore understand the basics of Ethereum development, including contracts, state, external calls, etc...")])]),t._v(" "),a("h3",{attrs:{id:"the-stack"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#the-stack"}},[t._v("#")]),t._v(" The Stack")]),t._v(" "),a("p",[t._v("The EVM runs as a stack machine with a depth of 1024 items. Each item is a 256 bit word (32 bytes), which was chosen due its compatibility with 256-bit encryption. Since the EVM is a stack-based VM, you typically PUSH data onto the top of it, POP data off, and apply instructions like ADD or MUL to the first few values that lay on top of it.")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://i.imgur.com/q6iEY7Z.png",width:"640px"}})]),t._v(" "),a("figcaption",{attrs:{align:"center"}},[a("b",[t._v("Fig.2 - Push/Pop Example from "),a("i",[t._v(' "Playdate with the EVM"')]),t._v(" by Femboy Capital")])]),t._v(" "),a("p",[t._v("Here's an example of what pushing to and popping from the stack looks like. On the left, we see an element, "),a("code",[t._v("e")]),t._v(", being pushed to the top of stack and on the right, we see how "),a("code",[t._v("e")]),t._v(' is removed or "popped" from it.')]),t._v(" "),a("p",[t._v("It's important to note that, while "),a("code",[t._v("e")]),t._v(" was the last element to be pushed onto the stack (it is preceded by a, b, c, d), it is the first element to be removed when a pop occurs. This is because stacks follow the "),a("strong",[t._v("LIFO")]),t._v(" (Last In, First Out) principle, where the last element to be added is the first element to be removed.")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"https://i.imgur.com/SYJBUBS.png",width:"640px"}})]),t._v(" "),a("figcaption",{attrs:{align:"center"}},[a("b",[t._v("Fig.3 - MUL Opcode Example from "),a("i",[t._v(' "Playdate with the EVM"')]),t._v(" by Femboy Capital")])]),t._v(" "),a("p",[t._v("Opcodes will often use stack elements as input, always taking the top (most recently added) elements. In the example above, we start with a stack consisting of "),a("code",[t._v("a")]),t._v(", "),a("code",[t._v("b")]),t._v(", "),a("code",[t._v("c")]),t._v(", and "),a("code",[t._v("d")]),t._v(". If you use the "),a("code",[t._v("MUL")]),t._v(" opcode (which multiplies the two values at the top of the stack), "),a("code",[t._v("c")]),t._v(" and "),a("code",[t._v("d")]),t._v(" get popped from the stack and replaced by their product.")]),t._v(" "),a("h3",{attrs:{id:"memory-and-calldata"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#memory-and-calldata"}},[t._v("#")]),t._v(" Memory and Calldata")]),t._v(" "),a("p",[t._v("In the EVM, memory can be thought of as an expandable, byte-addressed, 1 dimensional array. It starts out being empty,\nand it costs gas to read, write to, and expand it. Calldata on the other hand is very similar, but it is not able to be\nexpanded or overwritten. It is included in the transaction's payload, and acts as input for contract calls.")]),t._v(" "),a("p",[t._v("256 bit load & store:")]),t._v(" "),a("ul",[a("li",[t._v("Reading from memory or calldata will always access the first 256 bits (32 bytes or 1 word) after the given pointer.")]),t._v(" "),a("li",[t._v("Storing to memory will always write bytes to the first 256 bits (32 bytes or 1 word) after the given pointer.")])]),t._v(" "),a("p",[t._v("Memory and calldata are not persistent, they are volatile- after the transaction finishes executing,\nthey are forgotten.")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"/memory.png",width:"640px"}})]),t._v(" "),a("figcaption",{attrs:{align:"center"}},[a("b",[t._v("Fig.4 - Memory from "),a("i",[t._v("Ethereum EVM Illustrated")]),t._v(" by Takenobu T.")])]),t._v(" "),a("h4",{attrs:{id:"mnenomic-example"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mnenomic-example"}},[t._v("#")]),t._v(" Mnenomic Example")]),t._v(" "),a("div",{staticClass:"language-plaintext extra-class"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[t._v("PUSH2 0x1000 // [0x1000]\nPUSH1 0x00   // [0x00, 0x1000]\nMSTORE       // []\n// Memory: 0x00000000000000000000000000001000\n\nPUSH1 0x05   // [0x05]\nPUSH1 0x00   // [0x00, 0x05]\nMSTORE       // []\n// Memory: 0x0000000000000000000000000000100000000000000000000000000000000005\n\n0x00 MLOAD   // [0x1000]\n0x20 MLOAD   // [0x05, 0x1000]\n")])])]),a("h3",{attrs:{id:"storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#storage"}},[t._v("#")]),t._v(" Storage")]),t._v(" "),a("p",[t._v("All contract accounts on Ethereum are able to store data persistently inside of a key-value store. Contract storage\ncosts much more to read and write to than memory because after the transaction executes, all Ethereum nodes have to\nupdate the contract's storage trie accordingly.")]),t._v(" "),a("p",[t._v("Instead of imagining a large 1 dimensional array like we did with memory, you can think of storage like a 256 bit ->\n256 bit Map. There are a total of "),a("code",[t._v("2^256")]),t._v(" storage slots due to the 32 byte key size.")]),t._v(" "),a("p",{attrs:{align:"center"}},[a("img",{attrs:{src:"/contract_acc.png",width:"320px"}})]),t._v(" "),a("figcaption",{attrs:{align:"center"}},[a("b",[t._v("Fig.5 - Contract Account from "),a("i",[t._v("Ethereum EVM Illustrated")]),t._v(" by Takenobu T.")])]),t._v(" "),a("h4",{attrs:{id:"mnenomic-example-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mnenomic-example-2"}},[t._v("#")]),t._v(" Mnenomic Example")]),t._v(" "),a("div",{staticClass:"language-plaintext extra-class"},[a("pre",{pre:!0,attrs:{class:"language-plaintext"}},[a("code",[t._v("PUSH32 0xdEaDbEeFdEaDbEeFdEaDbEeFdEaDbEeF // [dead_addr]\nPUSH1 0x00                                // [0x00, dead_addr]\nSSTORE                                    // []\n\nPUSH32 0xC0FFEE00000000000000000000000000 // [coffee_addr]\nPUSH1 0x01                                // [0x01, coffee_addr]\nSSTORE                                    // []\n\n// Storage:\n// 0x00 -> 0xdEaDbEeFdEaDbEeFdEaDbEeFdEaDbEeF\n// 0x01 -> 0xC0FFEE00000000000000000000000000\n\nSLOAD 0x00                                // [dead_addr]\nSLOAD 0x01                                // [coffee_addr, dead_addr]\n")])])]),a("hr"),t._v(" "),a("p",[t._v("For more information on the EVM, see the "),a("RouterLink",{attrs:{to:"/resources/overview/#other-resources"}},[t._v("Resources")]),t._v(" section of the docs.")],1),t._v(" "),a("p",[t._v("If any of this confuses you, don't worry! While reading about the EVM will teach you the basics, actually writing assembly serves as the best way to get the hang of it (and it's the most fun). Let's dive into some simple projects.")])])}),[],!1,null,null,null);e.default=r.exports}}]);